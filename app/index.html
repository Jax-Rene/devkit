<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>devkit</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/tabs.css">
    <link rel="stylesheet" href="css/tabstyles.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
</head>

<body>
    <div class="container">
        <section>
            <div class="tabs tabs-style-circle">
                <nav class="tab-ul">
                    <ul>
                        <li><a href="#section-circle-1"><span class="fa fa-key fa-lg">&nbsp;code</span></a></li>
                        <li><a href="#section-circle-2" class="fa fa-internet-explorer fa-lg"><span>&nbsp;url</span></a>
                        </li>
                        <li><a href="#section-circle-3" class="fa fa-calendar fa-lg"><span>&nbsp;calendar</span></a></li>
                        <li><a href="#section-circle-4" class="fa fa-hand-grab-o fa-lg"><span>&nbsp;random</span></a></li>
                        <li><a href="#section-circle-5" class="fa fa-eraser fa-lg"><span>other</span></a></li>
                    </ul>
                </nav>
                <div class="content-wrap main-panel top-dashed">
                    <section id="section-circle-1">
                        <h1 class="config-h1">加密&解密</h1>
                        <div class="text-left">
                            <h2 class="config-h2">Md5计算</h2>
                        </div>
                        <div class="input-group">
                            <input type="text" placeholder="输入字符串,生成32位MD5" class="form-control" id="md5-origin" />
                            <span class="input-group-btn">
								<input type="button" class="btn btn-success" value="转换" id="convert-md5">
							</span>
                        </div>
                        <span id='md5-result' class='result'></span>
                    </section>
                    <section id="section-circle-2">
                        <div>
                            <h1 class="config-h1">URLencode</h1>
                            <div class="input-group">
                                <input type="text" placeholder="输入待encode字符串" class="form-control" id="encode-origin" />
                                <span class="input-group-btn">
									<input type="button" class="btn btn-success" value="转换" id="convert-encode">
								</span>
                            </div>
                            <span id='encode-result' class='result'></span>
                        </div>
                    </section>
                    <section id="section-circle-3">
                        <div>
                            <h1 class="config-h1">时间工具</small></h1>
                            <div class="text-left">
                                <h2 class="config-h2">时间戳转换</h2>
                            </div>
                            <div class="input-group">
                                <input type="text" placeholder="输入要转换的时间（yyyy-MM-dd hh:mm:ss）或者时间戳" class="form-control" id="date-origin" />
                                <span class="input-group-btn">
									<input type="button" class="btn btn-success convert-time" value="秒" id="second">
									<input type="button" class="btn btn-success convert-time" value="毫秒" id="msecond">
								</span>
                            </div>
                            <span id='date-result' class='result'></span>
                            <div class="text-left">
                                <h2 class="config-h2">获取当前时间</h2>
                            </div>
                            <div class="input-group">
                                <input type="text" placeholder="" class="form-control" id="now" />
                                <span class="input-group-btn">
									<input type="button" class="btn btn-success" value="复制" id="now-copy">
								</span>
                            </div>
                            <span id='now-result' class='result'></span>
                        </div>
                    </section>
                    <section id="section-circle-4">
                        <div>
                            <h1 class="config-h1">随机数</small></h1>
                            <div>
                                <div class="panel panel-success panel-4">
                                    <div class="panel-heading" style="background:#fff">
                                        <h3 class="panel-title">随机整（小）数</h3>
                                    </div>
                                    <div class="panel-body">
                                        <span class="title-span">请输入区间,放空则无视区间</span>
                                        <div class="row">
                                            <div class="col-md-5">
                                                <input type="text" placeholder="min" id="random-min" class="form-control">
                                            </div>
                                            <div class="col-md-2">
                                                —
                                            </div>
                                            <div class="col-md-5">
                                                <input type="text" placeholder="max" id="random-max" class="form-control" width="100%">
                                            </div>
                                        </div>
                                        <div class="row">
                                            <input type="button" value="生成" id="random-number" class="btn btn-success panel-4-button random">
                                        </div>
                                    </div>
                                </div>
                                <div class="panel panel-danger panel-5">
                                    <div class="panel-heading" style="background:#fff">
                                        <h3 class="panel-title">其他</h3>
                                    </div>
                                    <div class="panel-body">
                                        <div class="btn-group">
                                            <button type="button" id="random-boolean" class="btn btn-default random">随机布尔
                                            </button>
                                            <button type="button" id="random-date" class="btn btn-default random">随机日期
                                            </button>
                                            <button type="button" id="random-str" class="btn btn-default random">随机字符串
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <span class="result" id="random-result"></span>
                                </div>
                            </div>
                        </div>
                    </section>
                    <section id="section-circle-5">
                        <p>正在开发中...</p>
                    </section>
                </div>
            </div>
        </section>
    </div>
    <script src="js/cbpFWTabs.js"></script>
    <script>
    if (typeof module === 'object') {
        window.module = module;
        module = undefined;
    }
    </script>
    <script src="js/jquery-1.12.2.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/md5.min.js"></script>
    <script src="js/modernizr.custom.js"></script>
    <script type="text/javascript">
    $(function() {
        //tab
        [].slice.call(document.querySelectorAll('.tabs')).forEach(function(el) {
            new CBPFWTabs(el);
        });

        //复制
        const clipboard = require('electron').clipboard;

        $('#convert-md5').click(function() {
            var _md5 = md5($('#md5-origin').val());
            $('#md5-origin').val(_md5);
            clipboard.writeText(_md5.toString());
            $('#md5-result').text('生成结果已复制到黏贴板上');
        });

        $('#convert-encode').click(function() {
            var encoded = encodeURI($('#encode-origin').val());
            $('#encode-origin').val(encoded);
            clipboard.writeText(encoded.toString());
            $('#encode-result').text('生成结果已复制到黏贴板上');
        });

        $('.convert-time').click(function() {
            var regex = new RegExp('^(?:(?!0000)[0-9]{4}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-8])|(?:0[13-9]|1[0-2])-(?:29|30)|(?:0[13578]|1[02])-31)|(?:[ 0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)-02-29) [0-2][0-9]:[0-5][0-9]:[0-5][0-9]$'),
                originDate = $('#date-origin').val(),
                time;
            if (regex.test(originDate)) {
                time = new Date(originDate).getTime();
                if (this.id == 'second') {
                    time /= 1000;
                }
            } else {
            	originDate = parseInt(originDate);
                if (this.id == 'second') {
                    originDate  * 1000;
                }
                time = new Date(originDate).format('yyyy-MM-dd hh:mm:ss');
            }

            $('#date-origin').val(time);
            clipboard.writeText(time.toString());
            $('#date-result').text('生成结果已复制到黏贴板上');
        });

        Date.prototype.format = function(format) {
            var o = {
                "M+": this.getMonth() + 1, //month
                "d+": this.getDate(), //day
                "h+": this.getHours(), //hour
                "m+": this.getMinutes(), //minute
                "s+": this.getSeconds(), //second
                "q+": Math.floor((this.getMonth() + 3) / 3), //quarter
                "S": this.getMilliseconds() //millisecond
            }
            if (/(y+)/.test(format)) format = format.replace(RegExp.$1,
                (this.getFullYear() + "").substr(4 - RegExp.$1.length));
            for (var k in o)
                if (new RegExp("(" + k + ")").test(format))
                    format = format.replace(RegExp.$1,
                        RegExp.$1.length == 1 ? o[k] :
                        ("00" + o[k]).substr(("" + o[k]).length));
            return format;
        }


        //随机数
        $('.random').click(function() {
            var id = this.id;
            if (id == 'random-number') {
                var min = parseInt($('#random-min').val());
                var max = parseInt($('#random-max').val());
                if (isNaN(min) || isNaN(max))
                    $('#random-result').text('请输入区间范围');
                else {
                    var res = generateRandomNum(min, max);
                    clipboard.writeText(res.toString());
                    $('#random-result').text('随机数字: ' + res + ' 已复制到黏贴板');
                }
            } else if (id == 'random-boolean') {
                var res = generateRandomBoolean();
                clipboard.writeText(res.toString());
                $('#random-result').text('随机布尔值: ' + res + ' 已复制到黏贴板');
            } else if (id == 'random-date') {
                var res = new Date(generateRandomDate()).format('yyyy-MM-dd hh:mm:ss');
                clipboard.writeText(res.toString());
                $('#random-result').text('随机日期: ' + res + ' 已复制到黏贴板');
            } else {
                var res = generateRandomStr();
                clipboard.writeText(res.toString());
                $('#random-result').text('随机字符串: ' + res + ' 已复制到黏贴板');
            }
        });

        function updateTime(time) {
            if (!time)
                time = new Date().getTime();
            else
                time++;
            var res = new Date(time);
            $('#now').val(res.format('yyyy-MM-dd hh:mm:ss'));
            setTimeout(updateTime, 1000);
        }

        updateTime();
        $('#now-copy').click(function() {
            var res = $('#now').val();
            clipboard.writeText(res.toString());
            $('#now-result').text('当前时间已复制到黏贴板');
        });


        function generateRandomNum(min, max) {
            var range = max - min;
            var rand = Math.random();
            return (min + Math.round(rand * range));
        }

        function generateRandomBoolean() {
            var rand = Math.random();
            if (rand > 0.5)
                return true;
            else
                return false;
        }

        function generateRandomDate() {
            var base = 10000000000000;
            var rand = Math.random();
            return Math.round(base * rand);
        }

        function generateRandomStr(len) {
            len = len || 32;
            var $chars = 'ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678';
            /****默认去掉了容易混淆的字符oOLl,9gq,Vv,Uu,I1****/
            var maxPos = $chars.length;
            var pwd = '';
            for (i = 0; i < len; i++) {
                pwd += $chars.charAt(Math.floor(Math.random() * maxPos));
            }
            return pwd;
        }

        if (window.module) module = window.module;
    });
    </script>
</body>

</html>
